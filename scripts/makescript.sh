#!/bin/bash

p=`pwd`
for d in $(ls ./microservices); do
  arg=$1;

  cd $p/microservices/$d

  case $arg in
    --lint)
      echo "linting microservices/$d"
      go fmt
      golint
    ;;
    --test)
      echo "testing microservices/$d"
      go test
    ;;
    --bench)
      echo "testing microservices/$d"
      go test -bench=.
    ;;
    --build)
      echo "building microservices/$d"
      env GOOS=linux GOARCH=386 go build -o bin/$d # We want our executables to be output to the bin directory
    ;;
  esac
done

cd $p
